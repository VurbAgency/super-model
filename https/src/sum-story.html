<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">

<dom-module id="sum-story">
  <template>
    <style include="shared-styles">
       :host {
        display: block;

        padding: 10px;
      }

      main {
        display: block;
        width: 100%;
        height: 100%;
      }

      section {
        display: flex;
        flex-direction: row;
        justify-content: space-around;
        flex-wrap: wrap;
      }

    
    </style>

    <main>
      <section>

        <div class="card">
          <h1>Let’s Begin</h1>
          <p>So, you’ve decided to start a subscription company selling software to consumers.</p>
          <p>Congratulations. Subscription models are favored by many for their predictable recurring revenue streams and high margins. But they operate in unique ways, and you’ll need to understand the core customer logic in order to achieve optimal financial results. </p>
          <p>The goal of a subscription company is to retain a large percentage of subscribers.</p>          
        </div>

        <div class="card">
          <h1>Revenue and Customers: Pricing and Starting</h1>
          <p>Ok, let’s start with setting the price of your product per month.</p>
          <paper-input value="{{data.pricePerMonthT1}}" type="number" label="Price per month Tier 1"></paper-input>
          <paper-input value="{{data.pricePerMonthT2}}" type="number" label="Price per month Tier 2"></paper-input>
          <paper-input value="{{data.pricePerMonthT3}}" type="number" label="Price per month Tier 3"></paper-input>
          <paper-input value="{{data.pricePercentT1}}" type="number" label="Price percent tier 1"></paper-input>
          <paper-input value="{{data.pricePercentT2}}" type="number" label="Price percent tier 2"></paper-input>
          <paper-input value="{{data.pricePercentT3}}" type="number" label="Price percent tier 3"></paper-input>
          
          <p>This is of course the foundation value in your model.  The point of a tool like this is that you can continue to In deciding how to set this price, take into consideration the market of existing competitive products and your sense for what the customer will be willing to pay.</p>
          <p>Now, lets estimate the number of customers that you believe you can reasonably attain in the first month of your business.</p>
          <paper-input value="{{data.netNewCustomersStart}}" type="number" label="Net New Customers first month"></paper-input>
        </div>        
        
        <div class="card">
            <h1>Revenue and Customers: Growth and Retention</h1>
            <p>And from there, how much growth do you expect in year one, from month to month?</p>
            <paper-input value="{{data.growthRate}}" type="number" label="Growth rate month to month"></paper-input>
            <p>What percentage of your customers do you think will be with you after 6 months. </p>
            <paper-input value="{{data.retentionRateSixMonths}}" type="number" label="Retention rate at 6 months"></paper-input>
          </div>
        <div class="card">
            <h1>Lifetime Value per Customer</h1>
            <p>Here’s your estimated Lifetime Value per customer:</p>
            <p>{{_sumArrayValues(calculated.traditionalLifetimeValue)}}</p>
            <p>We used the traditional LTV calculation for now - just to keep things simple. Lifetime value will help us figure out how valuable your model is, and why.</p>
            <p>Here is your total revenue in year 1:</p>
            <!-- TODO: sum array Total revenue -->
            <!-- <p>{{_sumArrayValues(calculated.totalRevenue)}}</p> -->
            
        </div>
        <div class="card">
            <h1>Cost of Goods Sold: Human Resources</h1>
            <p>How many employees dedicated to keep the production environment running:</p>
            <paper-input value="{{data.staffInfrastructureHumans}}" type="number" label="staffInfrastructureHumans"></paper-input>
            <p>Employee salary:</p>
            <paper-input value="{{data.staffInfrastructureHumanPrice}}" type="number" label="staffInfrastructureHumanPrice"></paper-input>
            <p>How many employees dedicated to customer support / success of the software</p>
            <paper-input value="{{data.staffServiceHumans}}" type="number" label="staffSuccessHumans"></paper-input>
            <p>Employee salary:</p>
            <paper-input value="{{data.staffServiceHumansPrice}}" type="number" label="staffSuccessHumanPrice"></paper-input>
            <p>Other employees required to deliver the ongoing service:</p>
            <paper-input value="{{data.staffDeliveryOtherHumans}}" type="number" label="staffDeliveryOtherHumans"></paper-input>
            <p>Employee salary:</p>
            <paper-input value="{{data.staffDeliveryOtherHumanPrice}}" type="number" label="staffDeliveryOtherHumanPrice"></paper-input>
          </div>
        <div class="card">
            <h1>Cost of Goods Sold : Material Resources</h1>
            <p>Hosting and tech infrastructure in year 1</p>
            <paper-input value="{{data.costInitialTech}}" type="number" label="costInitialTech"></paper-input>
            <p>Any third-party software or data that is included in your delivered product</p>
            <paper-input value="{{data.costMonthlyTech}}" type="number" label="costMonthlyTech"></paper-input>
        </div>             

        <div class="card">
            <h1>Cost of Goods, Gross Margin & Total Lifetime Value</h1>
            <p>Total delivery employees:</p>
            <!-- TODO -->
            <!-- <p>{{_sumArrayValues(calculated.staffDeliveryTotalHumans)}}</p> -->
            <p>Here are your total cost of goods sold:</p>
            <p>{{_sumArrayValues(calculated.cogs)}}</p>
            <p>Here is your gross margin [PROFIT] %!</p>
            <p>{{_sumArrayValues(calculated.averageCustomerGrossMargin)}}</p>            
            <p class="italic">((rev - COGS)/revenue)</p>
            <p>Also here is the expected lifetime value of an average customer:</p>
            <p>{{_sumArrayValues(calculated.traditionalLifetimeValue)}}</p>
            <p>Your total estimated lifetime value is:</p>
            <!-- TODO: Zelfde als hierboven? -->
            <!-- <p>{{data.}}</p>          -->
            <p>Based on your retention rates and total customer lifespan assumptions.</p>
        </div>               
        
        <div class="card">
            <h1>Operating Margin / EBIT : Human Resources</h1>
            <p>How many employees will be involved in product development to keep your subscription product valuable and improving over time?</p>
            <paper-input value="{{data.staffProductHumans}}" type="number" label="staffProductHumans"></paper-input>
            <p>Employee salary:</p>
            <paper-input value="{{data.staffProductHumanPrice}}" type="number" label="staffProductHumanPrice"></paper-input>
            
            <p>How many employees will help retain customers ?</p>
            <paper-input value="{{data.staffSuccessHumans}}" type="number" label="staffSuccessHumans"></paper-input>
            <p>Employee salary:</p>
            <paper-input value="{{data.staffSuccessHumanPrice}}" type="number" label="staffSuccessHumanPrice"></paper-input>
          </div>                

        <div class="card">
            <h1>Operating Margin / EBIT : Material Resources</h1>
            <p>What’s the price of your office space in year 1:</p>
            <paper-input value="{{data.costOfficePerHuman}}" type="number" label="costOfficePerHuman"></paper-input>
            <p>What other supplies or materials do you plan in year 1:</p>
            <paper-input value="{{data.costSupplies}}" type="number" label="costSupplies"></paper-input>
            
            <p>Third party software for use in-house (not as part of your product)</p>
            <paper-input value="{{data.costSoftware}}" type="number" label="costSoftware"></paper-input>
          </div>                
        <div class="card">
            <h1>Operating Margin / EBIT overview</h1>
            <p>Here are how many humans you have at the year end of your first year in business:</p>
            <!-- TODO -->
            <!-- <p>{{data.}}</p> -->
            <p>OK! Let’s see your total operating costs</p>

            <p>{{_sumArrayValues(calculated.totalOperatingCosts)}}</p>
            <p>Here’s your operating margin, otherwise known as EBIT:</p>
            <p>{{_sumArrayValues(calculated.averageCustomerGrossMargin)}} %</p>            
            
            <p>{{_avgArrayValues(calculated.netOperatingMargin)}} %</p>            
        </div>                        
      </section>
    </main>

    

  </template>

  <script>
    class SumStory extends Polymer.Element {
      static get is() { return 'sum-story'; }
      /**
       * Object describing property-related metadata used by Polymer features
       */
       static get properties() {
        return {
          data: {
           type: Object,
           notify: true
          },
          calculated: Object
        };
      }      
      _sumArrayValues(array){
        if(array) return array.reduce((a, b) => a + b, 0);
      }
      _avgArrayValues(array){
        console.log(array)
        if(array) return array.reduce((a, b) => a + b, 0)/array.length;
      }
    }

    window.customElements.define(SumStory.is, SumStory);
  </script>
</dom-module>
